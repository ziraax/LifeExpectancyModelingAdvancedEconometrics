"0","# Filtrer pour ne garder qu'une seule année (par exemple, la plus récente disponible)"
"0","df_clean <- df %>%"
"0","  pivot_longer(cols = starts_with(""20""), "
"0","               names_to = ""Year"", "
"0","               values_to = ""Value"") %>%"
"0","  filter(!is.na(Value)) %>%"
"0","  group_by(`Country Name`, `Country Code`, `Series Name`, `Series Code`) %>%"
"0","  slice_max(Year) %>%  # Prend la dernière année disponible"
"0","  ungroup()"
"0",""
"0","# Transformer les séries en colonnes"
"0","df_wide <- df_clean %>%"
"0","  select(-Year, -`Series Code`) %>%"
"0","  pivot_wider(names_from = `Series Name`, values_from = Value) %>%"
"0","  drop_na()  # Supprime les lignes contenant des NA"
"0",""
"0","# Pour plus de simplicité, renommage des colonnes"
"0","df_wide <- df_wide %>% "
"0","  rename("
"0","    Country_Name = `Country Name`,"
"0","    Country_code = `Country Code`,"
"0","    Corruption = `Control of Corruption: Estimate`,"
"0","    Health_Expenditure = `Current health expenditure per capita, PPP (current international $)`,"
"0","    Education = `Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)`,"
"0","    GDP = `GDP per capita, PPP (constant 2021 international $)`,"
"0","    Life_Expectancy = `Life expectancy at birth, total (years)`,"
"0","    Pollution = `PM2.5 air pollution, mean annual exposure (micrograms per cubic meter)`"
"0","  )"
"0",""
"0","head(df_wide)"
